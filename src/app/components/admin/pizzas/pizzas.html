<h3>Pizzák kezelése</h3>


<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    <i class="bi-plus-circle"></i> Új pizza felvétele
  </button>
  
<table class="table table-hover table-striped">
    <thead>
        <th>#</th>
        <th>Kép</th>
        <th>Megnevezés</th>
        <th>Leírás</th>
        <th class="text-end">Kalória</th>
        <th class="text-end">Ár</th>
        <th class="text-end">Műveletek</th>
    </thead>
    <tbody>
        <tr *ngFor="let pizza of pagedPizza; let i = index">
            <td>{{i+1}}</td>
            <td><img  src="http://localhost:3000/uploads/{{pizza.image}}" alt="{{pizza.name}}" class="thumbnail" (click)="openlightbox(pizza.image)">
            </td>  
            <td>{{pizza.name}}</td>
            <td>{{pizza.description}}</td>
            <td class="text-end">{{pizza.calory | number}} kcal</td>
            <td class="text-end">{{pizza.price | numberformat}} {{currency}} </td>
            <td class="text-end">
                <button class="btn btn-warning me-2"><i class="bi-pencil" data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="getPizza(pizza.id)"></i></button>
                <button class="btn btn-danger" data-bs-toggle="modal" ><i class="bi-trash" (click)="confirmDelete(pizza.id)"></i></button>
            </td>
        </tr>
    </tbody>
    <tfoot>
        <tr >
            <td class="text-center" colspan="7">Összesen: <strong>{{pizzas.length}}</strong>  rekord</td>
        </tr>
    </tfoot>
</table>
<nav aria-label="Page navigation example" *ngIf="totalPages>1">
    <ul class="pagination">
      <li class="page-item">
        <a class="page-link"  aria-label="Previous" (click)="setPage(currentpage-1)" [class.disabled]="currentpage ===1">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i =index"><a class="page-link" (click)="setPage(i+1)" [class.active]="currentpage==i+1">{{i+1}}</a></li>
      
      <li class="page-item">
        <a class="page-link" aria-label="Next" (click)="setPage(currentpage+1) " [class.disabled]="currentpage ===5">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </nav>


<!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel" *ngIf="!editMode">Pizza hozzáadása</h1>
          <h1 class="modal-title fs-5" id="exampleModalLabel" *ngIf="editMode">Pizza hozzáadása</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" (click)="cancel()" aria-label="Close"></button>
        </div>
        <div class="modal-body">
         
          <div class="form-floating mb-3">
            <input type="text" class="form-control" id="name" placeholder="name" [(ngModel)]="pizza.name">
            <label for="name">Név <em>*</em></label>
          </div>
          <div class="form-floating mb-3">
            <input type="number" class="form-control" id="calories" placeholder="name" [(ngModel)]="pizza.calory">
            <label for="calories">Kalória <em>*</em></label>
          </div>
          <div class="form-floating mb-3">
            <input type="number" class="form-control" id="price" placeholder="name"  [(ngModel)]="pizza.price">
            <label for="price">Ár: <em>*</em></label>
          </div>
          <div class="mb-3" *ngIf="pizza.image==''">
            
            <input class="form-control" type="file" id="image" accept="image/*" (change)="onFileSelected($event)">
          </div>
          <div class="mb-3" *ngIf="pizza.image!=''">
            <img *ngIf="pizza.image" src="http://localhost:3000/uploads/{{pizza.image}}" alt="{{pizza.name}}" (click)="openlightbox(pizza.image)" class="thumbnail">
             <button class="btn btn-danger ms-3" (click)="deleteimage(pizza.id,pizza.image)"><i class="bi bi-trash3-fill"></i></button>
            <input class="form-control" type="file" id="image" accept="image/*" (change)="onFileSelected($event)">
          </div>
          <div class="form-floating mb-3">
            <input type="text" class="form-control" id="description" placeholder="name"  [(ngModel)]="pizza.description">
            <label for="description">Leírás <em>*</em></label>
          </div>



        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="cancel()">Close</button>
          <button type="button" class="btn btn-primary" (click)="save()">Mentés</button>
        </div>
      </div>
    </div>
  </div>
<!-- Törlés Modal -->

  <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="confirmModalLabel">Megerősítés</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Biztosan törölni szeretné?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-danger" (click)="delete(pizza.id)"><i class="bi-x-circle"></i> Delete</button>
        </div>
      </div>
    </div>
  </div>
  <app-lightbox [imageUrl]="lightBoxImage" [visible]="lightBoxVisible" (closed)="lightBoxVisible"></app-lightbox>